#!/usr/bin/env python3
"""
–¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ email –¥–ª—è CryptoWatch MEXC
"""

import sys
import os

def test_email_sending():
    """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ email"""
    
    print("üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ email...")
    print("=" * 50)
    
    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
        print("1Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...")
        from email_config import get_email_config
        
        config = get_email_config()
        print(f"‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞: {config['smtp']['email']}")
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º email —Å–µ—Ä–≤–∏—Å
        print("\n2Ô∏è‚É£ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è email —Å–µ—Ä–≤–∏—Å–∞...")
        from email_service import EmailService
        
        email_service = EmailService()
        print("‚úÖ Email —Å–µ—Ä–≤–∏—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
        
        # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º email –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        print("\n3Ô∏è‚É£ –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞...")
        test_email = input("üìß –í–≤–µ–¥–∏—Ç–µ email –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ").strip()
        
        if not test_email:
            print("‚ùå Email –Ω–µ —É–∫–∞–∑–∞–Ω!")
            return False
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π –∫–æ–¥
        print(f"üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ–¥–∞ –Ω–∞ {test_email}...")
        
        result = email_service.send_verification_code(
            to_email=test_email,
            code="123456",
            username="–¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
        )
        
        if result["success"]:
            print("‚úÖ –£–°–ü–ï–•! Email –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!")
            print(f"üìù –°–æ–æ–±—â–µ–Ω–∏–µ: {result['message']}")
            print("\nüéâ –°–∏—Å—Ç–µ–º–∞ email —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!")
            return True
        else:
            print(f"‚ùå –û–®–ò–ë–ö–ê: {result['error']}")
            return False
            
    except Exception as e:
        print(f"‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: {e}")
        print("\nüîß –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:")
        print("1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ email_config.py")
        print("2. –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ")
        print("3. –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø–∞—Ä–æ–ª—è/App Password")
        print("4. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ email –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞")
        return False

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print("üöÄ CryptoWatch MEXC - –¢–µ—Å—Ç Email –°–∏—Å—Ç–µ–º—ã")
    print("=" * 50)
    
    success = test_email_sending()
    
    if success:
        print("\nüéØ –†–ï–ó–£–õ–¨–¢–ê–¢: –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!")
        print("üí° –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å auth_api.py")
    else:
        print("\n‚ùå –†–ï–ó–£–õ–¨–¢–ê–¢: –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞!")
        print("üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: website/SETUP_EMAIL.md")
        sys.exit(1)

if __name__ == "__main__":
    main()
